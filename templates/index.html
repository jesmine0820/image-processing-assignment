<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Live Camera</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <div class="container">
    <!-- Side bar -->
    <div class="side-bar">
      <!-- Logo -->
      <div class="logo-container">
        <img class="logo" src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo">
        <h2 class="logo-text">FaceCert</h2>
      </div>
      
      <!-- Counter -->
      <div class="counter-buttons">
        <button onclick="showCounter(1, 'face')">Counter 1</button>
        <button onclick="showCounter(2, 'barcode')">Counter 2</button>
        <button onclick="showCounter(3, 'track')">Counter 3</button>
      </div>
      
      <!-- Model Selection Section -->
      <div class="model-selection">
        <h3>Face Recognition Model</h3>
        <select id="face-recognition" onchange="saveSettings()">
          <option value="insightFace">InsightFace</option>
          <option value="mtcnn_facenet">MTCNN with FaceNet</option>
        </select>
        
        <h3>Barcode Detection Model</h3>
        <select id="barcode-detection" onchange="saveSettings()">
          <option value="zxing">ZXingCpp</option>
          <option value="pyzbar">ZBar</option>
        </select>
        
        <div id="save-status" class="save-status"></div>
      </div>

      <!-- Send Email Button -->
      <div class="send-button">
        <button onclick="sendEmail()">Send Graduation Email</button>
      </div>
    </div>

    <!-- Camera field -->
    <div class="camera">
      <!-- Counter 1 -->
      <div id="counter1" class="counter-view active">
        <div class="counter-frame">
          <h2>Counter 1</h2>
          <div class="counter-layout">
            <div class="camera-feed">
              <img src="" alt="Camera 1">
            </div>
            <div class="scanner-section">
              <div class="barcode-scanner">
                <h3>Barcode Scan</h3>
                <button id="barcodeBtn" onclick="scanBarcode()" disabled>Scan Barcode</button>
              </div>

              <div class="person-info">
                <h3>Person Info</h3>
                <p><strong>ID: </strong> <span id="personId">---</span></p>
                <p><strong>Name: </strong> <span id="personName">---</span></p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Counter 2 -->
      <div id="counter2" class="counter-view">
        <div class="counter-frame">
          <h2>Counter 2</h2>
          <div class="counter-layout">
            <!-- Left side: camera feed -->
            <div class="camera-feed">
              <img src="" alt="Camera 2">
            </div>
            <!-- Right side: person details -->
            <div class="person-section">
              <div class="person-image">
                <img id="personPhoto" src="" alt="Person Photo">
              </div>
              <div class="person-info">
                <h3>Person Info</h3>
                <p><strong>ID: </strong> <span id="personId2">---</span></p>
                <p><strong>Name: </strong> <span id="personName2">---</span></p>
                <button onclick="clearCounter2Display()" class="clear-btn">Clear Display</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Counter 3 -->
      <div id="counter3" class="counter-view">
        <div class="counter-frame">
          <h2>Counter 3</h2>
          <div class="counter-layout">
            <!-- Left: camera feed -->
            <div class="camera-feed">
              <img src="" alt="Camera 3">
            </div>
            <!-- Right: queue + candidate -->
            <div class="queue-section">
              <div class="queue-display">
                <h3>Queue List</h3>
                <ul id="queueList"></ul>
                <div class="tracking-controls">
                  <button id="startButton" class="btn btn-green" onclick="startTracking()">Start</button>
                  <button id="stopButton" class="btn btn-red" onclick="stopTracking()">Stop</button>
                  <button id="resumeButton" class="btn btn-blue" onclick="resumeTracking()">Resume</button>
                  <button class="btn btn-gray" onclick="checkQueue()">Check Queue</button>
                </div>  
              </div>
              <div class="text-input">
                <h3>Candidate</h3>
                <p><strong>Current: </strong> <span id="currentPerson">---</span></p>
                <p><strong>Next: </strong> <span id="nextPerson">---</span></p>
              </div>
            </div>
          </div>
        </div>
      </div>

  <!-- QR Code Popup -->
  <div id="qrPopup" class="qr-popup hidden">
    <h3>ðŸŽ“ Graduation Ticket</h3>
    <img id="qrImage" src="" alt="QR Code">
  </div>

  <div id="verificationModal" class="modal hidden">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h3>Identity Verification</h3>
      <div id="verificationResult"></div>
      <div id="qrDisplay" class="hidden">
        <img id="verifiedQR" src="" alt="Verified QR Code">
        <p>This QR code will disappear in <span id="countdown">10</span> seconds</p>
      </div>
    </div>
  </div>

  <!-- Success message -->
  <div id="successMessage" class="hidden success-banner">
    ðŸŽ‰ QR Code Generated and Email Sent Successfully!
  </div>

  <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>
